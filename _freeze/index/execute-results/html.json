{
  "hash": "07affa57f0f12e830a42a26d0eab4057",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  revealjs:\n    incremental: false\n    theme: [default, custom.scss]\nexecute: \n  echo: true\n---\n\n\n\n\n\n## babelquartoによるquartoウエブサイトの多言語化 {.theme-slide1 .line}\n\n<br>\n\nニッタ ジョエル\n\n<br>\n\n::: {.medium}\n\n<https://joelnitta.github.io/2024-12-07-japanr>\n\n`Japan.R2024`\n\n:::\n\n::: {.aside}\n\n::: {.small}\n\nImage: [Alexandre Debiève on Unsplash](https://unsplash.com/ja/%E5%86%99%E7%9C%9F/%E3%83%A9%E3%82%B8%E3%82%AA%E3%83%97%E3%83%AC%E3%83%BC%E3%83%A4%E3%83%BC%E3%83%AD%E3%83%83%E3%83%88-UmX-OgGODfM)\n\n:::\n\n:::\n\n## 自己紹介：`@joelnitta` {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n- 千葉大学 准教授\n- シダ植物の進化や生態学\n- Rパッケージ開発（進化生態学系）\n\n<https://www.joelnitta.com>\n:::\n\n::: {.column width=\"50%\"}\n![](https://github.com/joelnitta/joelnitta-site/blob/master/static/media/headers/research_img2.jpg?raw=true){fig-alt=\"Image of Joel Nitta in field\" height=\"450\"}\n:::\n\n:::\n\n## Quarto はすごいぞ {.line}\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n- QuartoはRやPythonの計算結果を直接文章に入れるツール\n  - HTML（ウェブサイト、スライド、本）\n  - PDF\n  - MS Word\n:::\n\n::: {.column width=\"60%\"}\n![](https://rstudio.github.io/cheatsheets/html/images/quarto-illustration.png)\n:::\n\n::::\n\n## Quarto の多言語機能がまだ出来ていない {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- しかし、Quartoは比較的新しいため、欠けている機能もあります。\n\n- 備え付けで**多言語機能**がありません\n:::\n\n::: {.column width=\"50%\"}\n![](images/multi_lang_issue.png){width=90%}\n:::\n\n[<https://github.com/quarto-dev/quarto-cli/issues/275>]{.medsmall}\n\n::::\n\n## `babelquarto` {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Quarto BookかWebsiteの**各言語**のバージョンを**レンダーする**\n\n- （翻訳とは別）\n\n- Quartoのpluginではなく、Rパッケージ\n:::\n\n::: {.column width=\"50%\"}\n![](images/babelquarto_pagedown.png)\n\n[<https://docs.ropensci.org/babeldown/>]{.medsmall}\n:::\n\n::::\n\n## 例：ソフトウェア・カーペントリー日本 {.medsmall}\n\n<iframe src=\"https://swcarpentry-ja.github.io/\" width=\"100%\" height=\"500px\"></iframe>\n\n[<https://swcarpentry-ja.github.io/>]{.large}\n\n## 注意 {.line}\n\n- いつか多言語機能がQuartoに加わる可能性があります。\n\n- その場合、`babelquarto`は要らなくなるでしょう。\n\n- でも開発スクジュールが分かりませんので、多言語のニーズが今あれば使ってもいいと思います。\n\n# babelquarto demo {.line}\n\n## 基本的なサイトを作る\n\n\n\n::: {.cell}\n\n:::\n\n\n\n:::: {.columns}\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(quarto)\nquarto_create_project(\n  name = \"example\",\n  type = \"website\",\n  no_prompt = TRUE,\n  quiet = TRUE\n)\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nexample\n├── _quarto.yml\n├── about.qmd\n├── index.qmd\n└── styles.css\n```\n\n\n:::\n:::\n\n\n\n:::\n\n::::\n\n## 基本的なサイトを作る\n\n:::: {.columns}\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(quarto)\nquarto_create_project(\n  name = \"example\",\n  type = \"website\",\n  no_prompt = TRUE,\n  quiet = TRUE\n)\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\" .medsmall}\n\n\n\n::: {.cell filename='example/_quarto.yml'}\n\n```{.r .cell-code}\nproject:\n  type: website\n\nwebsite:\n  title: \"example\"\n  navbar:\n    left:\n      - href: index.qmd\n        text: Home\n      - about.qmd\n\nformat:\n  html:\n    theme: cosmo\n    css: styles.css\n    toc: true\n```\n:::\n\n\n\n:::\n\n::::\n\n## 主言語を登録する\n\n:::: {.columns}\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(babelquarto)\nregister_main_language(\n  main_language = \"ja\",\n  project_path = \"example\"\n)\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell filename='example/_quarto.yml'}\n\n```{.r .cell-code  code-line-numbers=\"|21-26\"}\nproject:\n  type: website\n\nwebsite:\n  title: \"example\"\n  navbar:\n    left:\n      - href: index.qmd\n        text: Home\n      - about.qmd\n\nformat:\n  html:\n    theme: cosmo\n    css: styles.css\n    toc: true\n\n\n\n\nbabelquarto:\n  languagecodes:\n  - name: ja\n    text: \"Version in ja\"\n  mainlanguage: 'ja'\nlang: ja\n```\n:::\n\n\n:::\n\n::::\n\n## 翻訳言語を追加する\n\n:::: {.columns}\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(babelquarto)\nregister_further_languages(\n  further_languages = c(\"en\"),\n  project_path = \"example\"\n)\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\" .medsmall}\n\n\n::: {.cell filename='example/_quarto.yml'}\n\n```{.r .cell-code  code-line-numbers=\"|21-32\"}\nproject:\n  type: website\n\nwebsite:\n  title: \"example\"\n  navbar:\n    left:\n      - href: index.qmd\n        text: Home\n      - about.qmd\n\nformat:\n  html:\n    theme: cosmo\n    css: styles.css\n    toc: true\n\n\n\n\nbabelquarto:\n  languagecodes:\n  - name: en\n    text: \"Version in en\"\n  - name: ja\n    text: \"Version in ja\"\n  mainlanguage: 'ja'\n  languages: ['en']\ntitle-en: title in en\ndescription-en: description in en\nauthor-en: author in en\nlang: ja\n```\n:::\n\n\n:::\n\n::::\n\n## `_quarto.yml`を編集する\n\n:::: {.columns .medsmall}\n\n::: {.column width=\"48%\"}\n\n\n::: {.cell filename='example/_quarto.yml'}\n\n```{.r .cell-code  code-line-numbers=\"|5,24,26,29-30\"}\nproject:\n  type: website\n\nwebsite:\n  title: \"example\"\n  navbar:\n    left:\n      - href: index.qmd\n        text: Home\n      - about.qmd\n\nformat:\n  html:\n    theme: cosmo\n    css: styles.css\n    toc: true\n\n\n\n\nbabelquarto:\n  languagecodes:\n  - name: en\n    text: \"Version in en\"\n  - name: ja\n    text: \"Version in ja\"\n  mainlanguage: 'ja'\n  languages: ['en']\ntitle-en: title in en\ndescription-en: description in en\nauthor-en: author in en\nlang: ja\n```\n:::\n\n\n:::\n\n::: {.column width=\"4%\" .center .large}\n**→**\n:::\n\n::: {.column width=\"48%\"}\n\n\n\n\n::: {.cell filename='example/_quarto.yml'}\n\n```{.r .cell-code  code-line-numbers=\"|8-9,5,23,25,28-29\"}\nproject:\n  type: website\n\nwebsite:\n  title: \"テスト用のサイト\"\n  navbar:\n    left:\n      - index.qmd\n      - about.qmd\n\nformat:\n  html:\n    theme: cosmo\n    css: styles.css\n    toc: true\n\n\n\n\nbabelquarto:\n  languagecodes:\n  - name: en\n    text: \"English\"\n  - name: ja\n    text: \"日本語\"\n  mainlanguage: 'ja'\n  languages: ['en']\ntitle-en: Test Site\ndescription-en: My test website\nauthor-en: Joel Nitta\nlang: ja\n```\n:::\n\n\n\n:::\n\n::::\n\n## 翻訳ファイルを追加する\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nexample\n├── _quarto.yml\n├── about.qmd\n├── index.qmd\n└── styles.css\n```\n\n\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"20%\" .center .large}\n**→**\n:::\n\n::: {.column width=\"46%\"}\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nexample\n├── _quarto.yml\n├── about.en.qmd\n├── about.qmd\n├── index.en.qmd\n├── index.qmd\n└── styles.css\n```\n\n\n:::\n:::\n\n\n\n:::\n\n::::\n\n---\n\n:::: {.columns .medsmall}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell filename='example/index.qmd'}\n\n```{.r .cell-code}\n---\ntitle: \"ホーム\"\n---\n\nこれは Quarto のウェブサイトです。\n\nQuarto のウェブサイトについて詳しく知りたい場合は、<https://quarto.org/docs/websites> をご覧ください。\n```\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell filename='example/index.en.qmd'}\n\n```{.r .cell-code}\n---\ntitle: \"Home\"\n---\n\nThis is a Quarto website.\n\nTo learn more about Quarto websites visit <https://quarto.org/docs/websites>.\n```\n:::\n\n\n\n:::\n\n::::\n\n## レンダーする\n\n注意：`quarto render`が使えません\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_website(project_path = \"example\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\u001b[1m\u001b[34m\n[1/2] index.qmd\u001b[39m\u001b[22m\n\u001b[1m\u001b[34m\n[2/2] about.qmd\u001b[39m\u001b[22m\n\nOutput created: _site/index.html\n\n\u001b[1m\u001b[34m\n[1/2] index.qmd\u001b[39m\u001b[22m\n\u001b[1m\u001b[34m\n[2/2] about.qmd\u001b[39m\u001b[22m\n\nOutput created: _site/index.html\n```\n\n\n:::\n:::\n\n\n\n## サーブする\n\n注意：`quarto preview`が使えません\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nservr::httw(\"example/_site\")\n```\n:::\n\n\n\n<iframe src=\"https://joelnitta.github.io/example-babelquarto/\" width=\"100%\" height=\"400px\"></iframe>\n\n[<https://joelnitta.github.io/example-babelquarto/>]{.medsmall}\n\n## まとめ {.line}\n\n- `_quarto.yml`に`babelquarto:`フィルドを加える\n- それぞれの`.qmd`ファイルの翻訳バージョンを加える\n  - `index.en.qmd`\n  - `about.en.qmd` など\n- レンダーには`babelquarto::render_website()`を使う\n\n## 内容の自動翻訳 {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Markdownやコードごと翻訳されると困る\n\n- **解決策 ①**：Custom GPT。プロンプトでMarkdownをいじらないように頼む。\n:::\n\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\n\n![](images/custom_gpt.png){width=200}\n\n[[Japanese Code Proofreader](https://chatgpt.com/g/g-673042d78e908190b7535ee1e91683be-japanese-code-proofreader)]{.medium}\n:::\n\n::::\n\n## 内容の自動翻訳 {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Markdownやコードごと翻訳されると困る\n\n- **解決策 ②**：`babeldown`。DeepLに送る前にMarkdownをXMLにパースすることによって内容だけを翻訳する\n:::\n\n::: {.column width=\"50%\"}\n![](images/babeldown_pagedown.png)\n[<https://docs.ropensci.org/babeldown/>]{.medsmall}\n:::\n\n::::\n\n## 翻訳の維持 {.line .smaller}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n- 元の文章が変わると、翻訳を更新する必要がある\n\n- `PO`ファイルを使うと各文章とそれに対する翻訳を管理できる\n\n- CrowdinやTransifexなど、クラウドツールが裏で`PO`ファイルを使っているものが多い\n:::\n\n::: {.column width=\"50%\"}\n\n![](https://localazy.com/directus9/assets/82fc8da9-d665-4604-940a-a3d0737e4857/?quality=80&format=webp)\n:::\n\n[<https://localazy.com/term/free-po-editor>]{.small}\n\n::::\n\n## 翻訳の維持 {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- ザ・カーペントリーズでは[Crowdin](https://carpentries.crowdin.com/)を使っています\n:::\n\n::: {.column width=\"50%\"}\n\n![](images/r-lesson-trans.svg)\n\n[<https://swcarpentry-ja.github.io/r-novice-gapminder/>]{.medsmall}\n\n:::\n\n::::\n\n\n## まとめ（2） {.line}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n多言語化はアケセスを増やすためにだけでなく、コミュニティを育むためにも大事です！\n\n[Enjoy!]{.medlarge}\n:::\n\n::: {.column width=\"40%\"}\n![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjc1QFOdIIO1Sp_7D4tRBG7frYYTvm_wAv9Swi1qvosxV3b34vBm7f2I5n9SEw-yjQm9LWxo-8h7lnSD7JApMNCQaCv1qtT_WysBClnhOFFPUzdNRkgvH6qaJpGNoW5kg36Wq3DSLhyphenhyphenoI/s800/tree_seichou02.png){fig-align=\"center\"}\n:::\n\n::::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}